new spark code
ver 1